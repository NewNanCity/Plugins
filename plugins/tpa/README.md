# TPA 传送请求插件

现代化的TPA（传送请求）插件，基于NewNanPlugins框架开发，提供完整的玩家间传送请求功能。

## 功能特性

### 🚀 核心功能
- **传送请求系统** - 支持 `/tpa` 和 `/tpahere` 两种传送模式
- **GUI界面** - 无参数命令自动打开玩家选择界面
- **智能冷却** - 可配置的冷却时间和权限绕过
- **请求管理** - 自动过期、取消和清理机制
- **安全检查** - 传送位置安全性验证
- **多语言支持** - 中文/英文语言包

### 🛡️ 安全特性
- **世界限制** - 可配置禁用TPA的世界列表
- **权限控制** - 细粒度的权限节点管理
- **屏蔽系统** - 玩家可屏蔽特定用户的请求
- **跨世界控制** - 可禁用跨世界传送
- **请求限制** - 防止请求滥用的数量限制

### 🎯 用户体验
- **交互式消息** - 聊天中的可点击按钮，支持悬浮提示
- **即时反馈** - 实时状态通知和倒计时
- **智能GUI** - 显示玩家头像、世界、距离信息
- **请求管理** - 专门的GUI界面管理所有传送请求
- **自动清理** - 离线玩家请求自动取消
- **延迟传送** - 可配置的传送延迟时间

## 命令系统

### 基础命令
- `/tpa [玩家]` - 请求传送到指定玩家身边
- `/tpa here [玩家]` - 请求指定玩家传送到你身边
- `/tpathere [玩家]` - 传送到指定玩家（别名）
- `/tpahere [玩家]` - 邀请玩家传送（别名）

### 响应命令
- `/tpa accept <ID>` - 接受指定ID的传送请求
- `/tpa reject <ID>` - 拒绝指定ID的传送请求

### 屏蔽管理
- `/tpa block <玩家>` - 屏蔽玩家的传送请求
- `/tpa unblock <玩家>` - 取消屏蔽玩家
- `/tpa blocklist` - 查看和管理屏蔽列表

### 管理命令
- `/tpa reload` - 重新加载插件配置
- `/tpa help` - 显示帮助信息

### GUI模式
当不指定玩家参数时，命令会自动打开GUI界面：
- `/tpa` - 打开传送到对方的玩家选择界面
- `/tpahere` - 打开对方传送到你的玩家选择界面

## 权限节点

| 权限                | 描述                | 默认    |
| ------------------- | ------------------- | ------- |
| `tpa.use`           | 允许使用基本TPA功能 | `true`  |
| `tpa.reload`        | 允许重载插件配置    | `op`    |
| `tpa.no-cool-down`  | 绕过冷却时间限制    | `false` |
| `tpa.bypass.worlds` | 绕过世界限制        | `false` |

## 配置文件

### config.yml
```yaml
# 是否启用插件
enable: true

# 冷却时间（秒）- 发送请求后的冷却时间
cool-down-seconds: 15

# 传送延迟时间（秒）- 接受请求后的传送倒计时
delay-seconds: 3

# 请求过期时间（秒）- 请求的有效期
expired-seconds: 60

# 禁用TPA的世界列表
exclude-worlds: []

# 调试模式 - 启用详细日志和性能监控
debug: false

# 消息设置
message-settings:
  # 玩家消息前缀
  player-prefix: "§7[§6TPA§7] §f"
  # 控制台消息前缀
  console-prefix: "[TPA] "
  # 是否在控制台中也显示玩家前缀
  enable-player-prefix-in-console: false
```

### 语言文件
插件支持多语言，语言文件位于 `lang/` 目录：
- `zh_CN.yml` - 简体中文
- `en_US.yml` - 英文

## 安装说明

### 依赖要求
- **CommandAPI** - 必需依赖，用于命令系统
- **Paper/Spigot** - 1.20+
- **Java** - 21+

### 安装步骤
1. 确保服务器已安装 CommandAPI 插件
2. 将 TPA 插件放入 `plugins` 目录
3. 重启服务器或使用 `/reload` 命令
4. 根据需要修改配置文件

## 使用示例

### 基础使用
```
/tpa Steve          # 请求传送到Steve身边
/tpa here Alex      # 请求Alex传送到你身边
/tpa accept 12345   # 接受ID为12345的传送请求
/tpa reject 12345   # 拒绝ID为12345的传送请求
```

### GUI使用
```
/tpa               # 打开玩家选择界面
/tpahere           # 打开玩家选择界面
/tpa blocklist     # 打开屏蔽列表管理界面
```

### 屏蔽管理
```
/tpa block Griefer      # 屏蔽Griefer的请求
/tpa unblock Griefer    # 取消屏蔽
/tpa blocklist          # 打开屏蔽列表GUI
```

### 交互式消息
当收到传送请求时，聊天中会显示带有可点击按钮的消息：
- **[接受]** - 绿色按钮，点击接受请求
- **[拒绝]** - 红色按钮，点击拒绝请求
- **[屏蔽]** - 灰色按钮，点击屏蔽发送者

## 技术特性

### 架构设计
- **BasePlugin集成** - 基于NewNanPlugins框架的现代化架构
- **资源管理** - 自动生命周期管理，防止内存泄漏
- **事件驱动** - 使用DSL语法的现代化事件处理
- **配置管理** - 基于Jackson的多格式配置支持

### 性能优化
- **并发安全** - 使用ConcurrentHashMap确保线程安全
- **自动清理** - 定期清理过期请求和冷却数据
- **缓存机制** - 智能缓存减少重复计算
- **异步处理** - 非阻塞的后台任务处理

## 开发信息

- **版本**: 2.0.0
- **框架**: NewNanPlugins
- **语言**: Kotlin
- **许可**: MIT License
- **作者**: NewNan City Development Team
