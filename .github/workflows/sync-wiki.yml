name: åŒæ­¥æ–‡æ¡£åˆ° Wiki (.wiki.git)

on:
  push:
    branches: [main, master]
    paths:
      - "docs/**"
      - "scripts/prepare-wiki-multi.py"
      - ".github/workflows/sync-wiki.yml"
  workflow_dispatch:

permissions:
  contents: write

concurrency:
  group: publish-wiki
  cancel-in-progress: true

jobs:
  publish-wiki:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: è®¾ç½® Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: ç”Ÿæˆ Wiki æ–‡æ¡£
        run: |
          python scripts/prepare-wiki-multi.py

      - name: å‘å¸ƒåˆ° GitHub Wiki
        uses: Andrew-Chen-Wang/github-wiki-action@v5
        with:
          # æ˜ç¡®æŒ‡å®šç›®æ ‡ä»“åº“ï¼ˆå³ https://github.com/NewNanCity/Plugins.wiki.git å¯¹åº”çš„ä¸»ä»“åº“ï¼‰
          repository: NewNanCity/Plugins
          path: wiki
          # å…¶ä½™ä¿æŒé»˜è®¤ï¼šä½¿ç”¨ ${{ github.token }} æ¨é€åˆ° .wiki.git

      - name: è¾“å‡ºåŒæ­¥ç»“æœ
        run: |
          echo "âœ… Wiki æ–‡æ¡£åŒæ­¥å®Œæˆ!"
          echo "ğŸ”— è®¿é—® Wiki: https://github.com/${{ github.repository }}/wiki"
